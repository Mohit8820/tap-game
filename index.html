<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />

    <title>Tap game</title>
  </head>
  <body id="body">
    <img src="/images/bgTap.jpg" alt="bg" class="bg" />
    <nav>
      <p>HI : <span id="high"></span></p>
      <div id="points">000</div>
      <div class="timer-container">
        <button class="reset" onclick="restart();">
          <svg
            clip-rule="evenodd"
            fill-rule="evenodd"
            stroke-linejoin="round"
            stroke-miterlimit="2"
            width="2.4rem"
            height="2.4rem"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="m3.508 6.726c1.765-2.836 4.911-4.726 8.495-4.726 5.518 0 9.997 4.48 9.997 9.997 0 5.519-4.479 9.999-9.997 9.999-5.245 0-9.553-4.048-9.966-9.188-.024-.302.189-.811.749-.811.391 0 .715.3.747.69.351 4.369 4.012 7.809 8.47 7.809 4.69 0 8.497-3.808 8.497-8.499 0-4.689-3.807-8.497-8.497-8.497-3.037 0-5.704 1.597-7.206 3.995l1.991.005c.414 0 .75.336.75.75s-.336.75-.75.75h-4.033c-.414 0-.75-.336-.75-.75v-4.049c0-.414.336-.75.75-.75s.75.335.75.75z"
              fill-rule="nonzero"
            />
          </svg>
        </button>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="2.4rem"
          height="2.4rem"
          viewBox="0 0 24 24"
        >
          <path
            d="M18.513 7.119c.958-1.143 1.487-2.577 1.487-4.036v-3.083h-16v3.083c0 1.459.528 2.892 1.487 4.035l3.086 3.68c.567.677.571 1.625.009 2.306l-3.13 3.794c-.936 1.136-1.452 2.555-1.452 3.995v3.107h16v-3.107c0-1.44-.517-2.858-1.453-3.994l-3.13-3.794c-.562-.681-.558-1.629.009-2.306l3.087-3.68zm-4.639 7.257l3.13 3.794c.652.792.996 1.726.996 2.83h-12c0-1.104.343-2.039.996-2.829l3.129-3.793c1.167-1.414 1.159-3.459-.019-4.864l-3.086-3.681c-.66-.785-1.02-1.736-1.02-2.834h12c0 1.101-.363 2.05-1.02 2.834l-3.087 3.68c-1.177 1.405-1.185 3.451-.019 4.863z"
          />
        </svg>
        <div id="timer">30s</div>
      </div>
    </nav>
    <div id="countdown"></div>
    <div id="intro">
      <button onclick="restart();">Start</button>
      <ul>
        <li><img src="/images/one.png" alt="" /> +100 points</li>
        <li><img src="/images/two.png" alt="" /> +200 points</li>
        <li><img src="/images/three.png" alt="" /> +300 points</li>
        <li><img src="/images/tooth.png" alt="" /> -150 points</li>
      </ul>
    </div>
  </body>
  <script>
    var highest = 0;
    var high = document.getElementById("high");
    if (localStorage) {
      if (localStorage.tapHi) highest = localStorage.tapHi;
      else {
        localStorage.setItem("tapHi", 0);
      }
    } else {
      // No support. Use a fallback such as browser cookies or store on the server.
    }
    high.innerText = highest;
    //matrix method 0 1 0 0(horizontally divided in 4 planes) or randomized
    function randno(n) {
      return Math.floor(Math.random() * n);
    }
    //add destructive tile
    var speeds = ["fast", "medium", "slow", "decay"];
    var positions = ["a", "b", "c", "d"];
    var t = 30;
    var points = 0;
    var elNo = 0;
    var body = document.getElementById("body");
    function createEl() {
      var spd = speeds[randno(4)];
      var pos = positions[randno(4)];
      var new_el = document.createElement("button");
      new_el.classList.add("element");
      new_el.classList.add(spd);
      new_el.classList.add(`${elNo}`);
      new_el.classList.add(pos);

      document.getElementById("body").appendChild(new_el);
      document
        .getElementsByClassName(`${elNo}`)[0]
        .addEventListener("click", function () {
          if (this.classList.contains("slow")) points = points + 100;
          else if (this.classList.contains("medium")) points = points + 200;
          else if (this.classList.contains("decay")) points = points - 150;
          else points = points + 300;
          document.getElementById("points").innerHTML = points;
          this.style.display = "none";
        });
      elNo++;
    }
    var myInterval;
    function begin() {
      myInterval = setInterval(myTimer, 1000);
    }
    var time = t;
    function myTimer() {
      document.getElementById("timer").innerHTML = time + "s";
      createEl();
      if (time === 0) myStop();
      time--;
    }
    function myStop() {
      clearInterval(myInterval);
      var elements = document.getElementsByClassName("element");
      var i = 0;
      for (i = 0; i < elements.length; i++) {
        console.log(i);
        elements[i].style.display = "none";
      }
      if (points > highest) {
        highest = points;
        if (localStorage) {
          localStorage.setItem("tapHi", points);
        }
      }
      high.innerText = highest;
      document.getElementById("intro").style.display = "block";
    }

    var c = 3;
    var start;
    function restart() {
      c = 3;
      time = t;
      points = 0;
      document.getElementById("intro").style.display = "none";
      document.getElementById("points").innerHTML = "000";
      document.getElementById("timer").innerHTML = time + "s";
      clearInterval(myInterval);
      clearInterval(start);
      start = setInterval(countdown, 1000);
    }

    function countdown() {
      document.getElementById("countdown").style.display = "block";
      if (c === 0) stopCoundown();
      document.getElementById("countdown").innerHTML = c;
      c--;
    }
    function stopCoundown() {
      document.getElementById("countdown").style.display = "none";
      clearInterval(start);
      begin();
    }
  </script>
</html>
